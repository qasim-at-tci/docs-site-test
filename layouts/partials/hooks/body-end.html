<div>{{ partial "mx-dock.html" . }}</div>

<!-- NK - the code below implements ToC element highlighting based on scroll action.
	It's taken from an example here:
	https://github.com/google/docsy/issues/281#issuecomment-640077009
	Changes from example:
	- adjusted the rootMargin, so the bounding box would be smaller.
	- added h4 and h5 elements
	An alternate value for rootMargin: '-200px 0px -800px 0px'
	Highlighting multiple headers is solved by clearActiveStatesInTableOfContents,
	taken from the page source and example at:
	https://ma.ttias.be/adding-a-sticky-table-of-contents-in-hugo-to-posts
-->
<script type="text/javascript">
	window.addEventListener("load", (event) => {
		createObserver();
	}, false);

	function createObserver() {
		let observer;

		let options = {
			root: document.querySelector('#main'),
			rootMargin: '-60px 0px -80% 0px',
            threshold: 0.1
		};

		observer = new IntersectionObserver((entries, observer) => {
			entries.forEach(entry => {
				const id = entry.target.getAttribute('id');
				if (entry.intersectionRatio > 0 ) {
					clearActiveStatesInTableOfContents();
					document.querySelector(`nav li a[href="#${id}"]`).classList.add('activeToc');
				}
			});
		},options);
			document.querySelectorAll('h2[id], h3[id], h4[id], h5[id]').forEach((section) => {
				observer.observe(section);
			});
	}

	function clearActiveStatesInTableOfContents() {
		document.querySelectorAll('aside nav li a').forEach((section) => {
			section.classList.remove('activeToc');
		});
	}
</script>